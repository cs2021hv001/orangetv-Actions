# OrangeTV 部署模板 (Fly.io)

这是一个使用 [Fly.io](https://fly.io) 部署 **OrangeTV** 应用的模板仓库，支持自动化 GitHub Actions 部署，并通过 **Secrets** 管理敏感信息，避免凭据泄露。

---

## ✨ 功能

- 使用 `ghcr.io/djteang/orangetv:latest` 官方镜像
- 自动化部署：支持 **GitHub Actions** 一键部署
- 免费额度内运行：`shared-cpu-1x` + `256MB RAM`
- 环境变量统一通过 **Secrets** 管理，安全可靠
- 支持 Redis Upstash 存储，无需磁盘挂载

---


## 推荐区域
### SIN：新加坡
### SJC：美国加利福尼亚州圣何塞
### AMS：荷兰阿姆斯特丹
### LHR：英国伦敦

---

## 🚀 部署流程

### 1. Fork 仓库
点击右上角 **Fork**，将本仓库复制到你自己的 GitHub 账户。

---

### 2. 创建 Fly.io 应用
在本地安装 [Fly CLI](https://fly.io/docs/hands-on/install-flyctl/)，并执行：


flyctl launch --name orangetv-app --no-deploy



---

### 3. 配置 GitHub Secrets

进入 GitHub → Settings → Secrets and variables → Actions，新增以下 secrets：
FLY_API_TOKEN	Fly.io API Token（用 flyctl auth token 获取）

### FLY令牌，可通过命令获取或网页创建--tokens
```
FLY_API_TOKEN
```

### 站长账号
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| USERNAME                            | 站长账号           | 任意字符串                       | 无默认，必填字段                                                                                                                     |
```
USERNAME
```

### 站长密码
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| PASSWORD                            | 站长密码           | 任意字符串                       | 无默认，必填字段                                                                                                                     |
```
PASSWORD
```

### 站点 url
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| SITE_BASE                           | 站点 url              |       形如 https://example.com                  | 空                                                                                                                     |
```
SITE_BASE
```

### 站点名称	
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| NEXT_PUBLIC_SITE_NAME               | 站点名称                                     | 任意字符串                       | OrangeTV                                                                                                                     |
```
NEXT_PUBLIC_SITE_NAME
```

### 站点公告
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| ANNOUNCEMENT                        | 站点公告                                     | 任意字符串                       | 本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。 |
```
ANNOUNCEMENT
```

### 播放记录/收藏的存储方式
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| NEXT_PUBLIC_STORAGE_TYPE            | 播放记录/收藏的存储方式                      | redis、kvrocks、upstash | 无默认，必填字段                                                                                                               |
```
NEXT_PUBLIC_STORAGE_TYPE
```

### upstash redis 连接 url
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| UPSTASH_URL                         | upstash redis 连接 url                       | 连接 url                         | 空                                                                                                                         |
```
UPSTASH_URL
```

### upstash redis 连接 token
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| UPSTASH_TOKEN                       | upstash redis 连接 token                     | 连接 token                       | 空                                                                                                                         |
```
UPSTASH_TOKEN
```

### 搜索接口可拉取的最大页数
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| NEXT_PUBLIC_SEARCH_MAX_PAGE         | 搜索接口可拉取的最大页数                     | 1-50                             | 5                                                                                                                          |
```
NEXT_PUBLIC_SEARCH_MAX_PAGE
```

### 豆瓣数据源请求方式
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| NEXT_PUBLIC_DOUBAN_PROXY_TYPE       | 豆瓣数据源请求方式                           | 见下方                           | direct                                                                                                                     |
```
NEXT_PUBLIC_DOUBAN_PROXY_TYPE
```

### 是否开启搜索接口流式输出
| 变量                                | 说明                                         | 可选值                           | 默认值                                                                                                                     |
| ----------------------------------- | -------------------------------------------- | -------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| NEXT_PUBLIC_FLUID_SEARCH | 是否开启搜索接口流式输出 | true/ false | true |
```
NEXT_PUBLIC_FLUID_SEARCH
```

